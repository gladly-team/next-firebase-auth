(()=>{"use strict";var e={421:e=>{e.exports=require("firebase/app")},942:e=>{e.exports=require("firebase/auth")}},t={};function r(n){var i=t[n];if(void 0!==i)return i.exports;var o=t[n]={exports:{}};return e[n](o,o.exports,r),o.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var n={};(()=>{r.d(n,{default:()=>K});const e=require("@babel/runtime/helpers/defineProperty");var t=r.n(e);const i=require("@babel/runtime/helpers/objectWithoutProperties");var o=r.n(i);const a=()=>"undefined"!=typeof window;var s=!1,u=e=>{s=e};const l=function(){if(s){for(var e=a()?["%cnext-firebase-auth","background: #ffa000; color: #fff; border-radius: 2px; padding: 2px 6px"]:["next-firebase-auth:"],t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];console.log(...e,...r)}};var c,h=["cookies"];function d(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function f(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?d(Object(n),!0).forEach((function(r){t()(e,r,n[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var p=12096e5,g={debug:!1,loginAPIEndpoint:void 0,logoutAPIEndpoint:void 0,tokenChangedHandler:void 0,authPageURL:void 0,appPageURL:void 0,firebaseAdminInitConfig:void 0,firebaseClientInitConfig:void 0,firebaseAuthEmulatorHost:void 0,cookies:{name:void 0,keys:void 0,domain:void 0,httpOnly:!0,maxAge:6048e5,overwrite:!0,path:"/",sameSite:"strict",secure:!0,signed:!0}},b=e=>{var t=[];e.tokenChangedHandler?(e.loginAPIEndpoint&&t.push('The "loginAPIEndpoint" setting should not be set if you are using a "tokenChangedHandler".'),e.logoutAPIEndpoint&&t.push('The "logoutAPIEndpoint" setting should not be set if you are using a "tokenChangedHandler".')):(e.loginAPIEndpoint||t.push('The "loginAPIEndpoint" setting is required.'),e.logoutAPIEndpoint||t.push('The "logoutAPIEndpoint" setting is required.')),e.firebaseClientInitConfig&&e.firebaseClientInitConfig.apiKey||t.push('The "firebaseClientInitConfig.apiKey" value is required.'),e.firebaseAuthEmulatorHost&&e.firebaseAuthEmulatorHost.startsWith("http")&&t.push("The firebaseAuthEmulatorHost should be set without a prefix (e.g., localhost:9099)");var{keys:r}=e.cookies,n=r&&r.length&&(!r.filter||r.filter((e=>void 0!==e)).length);return a()?(e.firebaseAdminInitConfig&&e.firebaseAdminInitConfig.credential&&e.firebaseAdminInitConfig.credential.privateKey&&t.push('The "firebaseAdminInitConfig" private key setting should not be available on the client side.'),n&&t.push('The "cookies.keys" setting should not be available on the client side.')):(e.cookies.name||t.push('The "cookies.name" setting is required on the server side.'),e.cookies.signed&&!n&&t.push('The "cookies.keys" setting must be set if "cookies.signed" is true.'),e.firebaseAuthEmulatorHost&&(process.env.FIREBASE_AUTH_EMULATOR_HOST?process.env.FIREBASE_AUTH_EMULATOR_HOST!==e.firebaseAuthEmulatorHost&&t.push('The "FIREBASE_AUTH_EMULATOR_HOST" environment variable should be the same as the host set in the config'):t.push('The "FIREBASE_AUTH_EMULATOR_HOST" environment variable should be set if you are using the "firebaseAuthEmulatorHost" option')),e.cookies.maxAge>p&&t.push('The "cookies.maxAge" setting must be less than two weeks ('.concat(p," ms)."))),{isValid:0===t.length,errors:t}},v=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};l("Setting config with provided value:",e);var{cookies:t={}}=e,r=o()(e,h),n=f(f(f({},g),r),{},{cookies:f(f({},g.cookies),t)}),{isValid:i,errors:a}=b(n);if(!i)throw new Error("Invalid next-firebase-auth options: ".concat(a.join(" ")));c=n},m=()=>{if(!c)throw new Error("next-firebase-auth must be initialized before rendering.");return c};const y=require("react");var E=r.n(y);const A=require("next/router"),w=require("@babel/runtime/helpers/asyncToGenerator");var O=r.n(w),T=["aud","auth_time","email","email_verified","exp","firebase","iat","iss","name","phone_number","picture","sub","uid","user_id"],I=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={};return Object.keys(e).forEach((r=>{T.includes(r)||(t[r]=e[r])})),t};function R(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function U(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?R(Object(n),!0).forEach((function(r){t()(e,r,n[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):R(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const k=function(){var{firebaseUserClientSDK:e,firebaseUserAdminSDK:t,serializedAuthUser:n,clientInitialized:i=!1,token:o=null,claims:s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};l("Called createAuthUser with arguments:",{firebaseUserClientSDK:e,firebaseUserAdminSDK:t,serializedAuthUser:n,clientInitialized:i,token:o,claims:s});var u=[e,t,n].reduce(((e,t)=>t?e+1:e),0);if(u>1)throw new Error('createAuthUser cannot receive more than one of the following properties: "firebaseUserClientSDK", "firebaseUserAdminSDK", "serializedAuthUser"');if(i&&(t||n))throw new Error('The "clientInitialized" value can only be true when called with the "firebaseUserClientSDK" property or no user.');if(s&&(t||n))throw new Error('The "claims" value can only be set in conjunction with the "firebaseUserClientSDK" property.');if(o&&!t)throw new Error('The "token" value can only be set if the "firebaseUserAdminSDK" property is defined.');var c,h={},d=null,f=null,p=!1,g=null,b=null,v=null,m=function(){var e=O()((function*(){return null}));return function(){return e.apply(this,arguments)}}();a()&&(r(942),c=r(421).default);var y=function(){var e=O()((function*(){}));return function(){return e.apply(this,arguments)}}(),E=null;if(e)h=I(s),d=e.uid,f=e.email,p=e.emailVerified,g=e.phoneNumber,b=e.displayName,v=e.photoURL,m=function(){var t=O()((function*(){return e.getIdToken()}));return function(){return t.apply(this,arguments)}}(),y=function(){var e=O()((function*(){return c.auth().signOut()}));return function(){return e.apply(this,arguments)}}(),E=null;else if(t)h=I(t),d=t.uid,f=t.email,p=t.email_verified,g=t.phone_number,b=t.name,v=t.picture,m=function(){var e=O()((function*(){return o}));return function(){return e.apply(this,arguments)}}(),E=o;else if(n){var A=JSON.parse(n);h=A.claims,d=A.id,f=A.email,p=A.emailVerified,g=A.phoneNumber,b=A.displayName,v=A.photoURL,m=function(){var e=O()((function*(){return A._token||null}));return function(){return e.apply(this,arguments)}}(),E=A._token}return{id:d,email:f,emailVerified:p,phoneNumber:g,displayName:b,photoURL:v,claims:h,getIdToken:m,clientInitialized:i,firebaseUser:e||null,signOut:y,serialize:function(){var{includeToken:e=!0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return JSON.stringify(U({id:d,claims:h,email:f,emailVerified:p,phoneNumber:g,displayName:b,photoURL:v,clientInitialized:i},e&&{_token:E}))}}};var P=(0,y.createContext)(k());var C=r(421),S=r.n(C),_=(r(942),function(){var e=O()((function*(e){var t,{loginAPIEndpoint:r,logoutAPIEndpoint:n}=m();if(e.id){var i=yield e.getIdToken();if(!(t=yield fetch(r,{method:"POST",headers:{Authorization:i},credentials:"include"})).ok){var o=yield t.json();throw new Error("Received ".concat(t.status," response from login API endpoint: ").concat(JSON.stringify(o)))}}else if(!(t=yield fetch(n,{method:"POST",credentials:"include"})).ok){var a=yield t.json();throw new Error("Received ".concat(t.status," response from logout API endpoint: ").concat(JSON.stringify(a)))}return t}));return function(t){return e.apply(this,arguments)}}()),D=function(){var e=O()((function*(e){var{tokenChangedHandler:t}=m(),r=k({firebaseUserClientSDK:e,clientInitialized:!0});return t?t(r):_(r)}));return function(t){return e.apply(this,arguments)}}();const L=()=>{var[e,t]=(0,y.useState)(),[r,n]=(0,y.useState)({}),[i,o]=(0,y.useState)(!1);function a(e){return s.apply(this,arguments)}function s(){return(s=O()((function*(e){if(e){var r=yield S().auth().currentUser.getIdTokenResult(),i=I(r.claims);n(i)}t(e),o(!0),yield D(e)}))).apply(this,arguments)}return(0,y.useEffect)((()=>{var e=S().auth().onIdTokenChanged(a);return()=>e()}),[]),{user:e,claims:r,initialized:i}},j={RENDER:"render",SHOW_LOADER:"showLoader",RETURN_NULL:"returnNull",REDIRECT_TO_LOGIN:"redirectToLogin",REDIRECT_TO_APP:"redirectToApp"},N=require("hoist-non-react-statics");var x=r.n(N),H=["AuthUserSerialized"];function z(){var{firebaseClientInitConfig:e,firebaseAuthEmulatorHost:t}=m();if(!S().apps.length){if(!e)throw new Error('If not initializing the Firebase JS SDK elsewhere, you must provide "firebaseClientInitConfig" to next-firebase-auth.');S().initializeApp(e)}t&&S().auth().useEmulator("http://".concat(t))}const K={init:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};u(!0===e.debug),v(e),a()&&z()},withAuthUser:function(){var{whenAuthed:e=j.RENDER,whenUnauthedBeforeInit:t=j.RENDER,whenUnauthedAfterInit:r=j.RENDER,appPageURL:n=null,authPageURL:i=null,LoaderComponent:s=null}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return u=>{var l=l=>{var{AuthUserSerialized:c}=l,h=o()(l,H),d=k({serializedAuthUser:c}),{user:f,claims:p,initialized:g}=L(),b=k({firebaseUserClientSDK:f,clientInitialized:g,claims:p}),v=g?b:d,w=!!v.id,O=v.clientInitialized,T=w&&e===j.REDIRECT_TO_APP,I=!w&&(!O&&t===j.REDIRECT_TO_LOGIN||O&&r===j.REDIRECT_TO_LOGIN),R=(0,A.useRouter)(),U=(0,y.useCallback)((()=>{var e=n||m().appPageURL;if(!e)throw new Error('The "appPageURL" config setting must be set when using `REDIRECT_TO_APP`.');var t="string"==typeof e?e:e({ctx:void 0,AuthUser:v});if(!t||"string"!=typeof t)throw new Error('The "appPageURL" must be set to a non-empty string or resolve to a non-empty string');R.replace(t)}),[R,v]),C=(0,y.useCallback)((()=>{var e=i||m().authPageURL;if(!e)throw new Error('The "authPageURL" config setting must be set when using `REDIRECT_TO_LOGIN`.');var t="string"==typeof e?e:e({ctx:void 0,AuthUser:v});if(!t||"string"!=typeof t)throw new Error('The "authPageURL" must be set to a non-empty string or resolve to a non-empty string');R.replace(t)}),[R,v]);if((0,y.useEffect)((()=>{a()&&(T?U():I&&C())}),[T,I,U,C]),T||I)return null;if(!O&&!w){if(t===j.SHOW_LOADER)return s?E().createElement(s,null):null;if(t===j.RETURN_NULL)return null}return E().createElement(P.Provider,{value:v},E().createElement(u,h))};return l.displayName="WithAuthUserHOC",x()(l,u),l}},useAuthUser:()=>(0,y.useContext)(P),withAuthUserSSR:()=>{throw new Error('"withAuthUserSSR" can only be called server-side.')},withAuthUserTokenSSR:()=>{throw new Error('"withAuthUserTokenSSR" can only be called server-side.')},setAuthCookies:()=>{throw new Error('"setAuthCookies" can only be called server-side.')},unsetAuthCookies:()=>{throw new Error('"unsetAuthCookies" can only be called server-side.')},verifyIdToken:()=>{throw new Error('"verifyIdToken" can only be called server-side.')},AuthAction:j,getFirebaseAdmin:()=>{throw new Error('"getFirebaseAdmin" can only be called server-side.')}}})(),module.exports=n.default})();